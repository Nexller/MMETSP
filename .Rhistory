version
packageStatus()
.libPaths()
source("http://bioconductor.org/biocLite.R")
biocLite("conumee")
library("optparse")
library("rmarkdown")
install.packages("manipulate")
install.packages(c("rmarkdown", "optparse", "knitr"))
library("rmarkdown")
library("knitr")
library(RCurl)
library(ggplot)
library(ggplot2)
URL<-("https://raw.githubusercontent.com/ryanjw/ngs-3rdweek/master/visualizations/datasets/fly_data.txt")
dataset<-read.table(textConnection(getURL(URL)),header=T,check.names=F,sep="\t")
ggplot(dataset)+geom_density(aes(x=FBgn0000022,fill=fly,alpha=0.5))
gglot(dataset)+geom_density
ggplot(dataset)+geom_histogram(aes(x=FBgn0000022,fill=fly,alpha=0.5))
ggplot(dataset)+geom_histogram(aes(x=FBgn0000022,fill=fly,alpha=0.5))
names(dataset)
names(dataset)[1:50]
ggplot(dataset)+geom_histogram(aes(x=FBgn0000056,fill=fly,alpha=0.5))
?geom_histogram
install.packages("vegan")
library(vegan)
adonis(dataset[,-c(1:3)]~dataset$fly*dataset$type)
head(dataset[,1:10])
?adonis
adonis(decostand(dataset[,-c(1:3)],method="total")~dataset$fly*dataset$type)
adonis(decostand(dataset[,-c(1:3)],method=c("pa","jaccard")~dataset$fly*dataset$type)
)
adonis(decostand(dataset[,-c(1:3)],method=c("pa","jaccard"))~dataset$fly*dataset$type)
adonis(decostand(dataset[,-c(1:3)],method="pa",method="jaccard")~dataset$fly*dataset$type)
adonis(decostand(dataset[,-c(1:3)],method="pa")~dataset$fly*dataset$type,method="jaccard")
URL<-("https://raw.githubusercontent.com/ryanjw/ngs-3rdweek/master/multivariate-viz/fly_data_with_unknowns.txt")
URL<-("https://raw.githubusercontent.com/ryanjw/ngs-3rdweek/master/visualizations/multivariate-viz/fly_data_with_unknowns.txt")
dataset<-read.table(textConnection(getURL(URL)),header=T,check.names=F,sep="\t")
dim(dataset)
head(dataset[,1:10])
tail(dataset[,1:10])
mds<-metaMDS(dataset[,-c(1:4)],distance="bray",autotransform=F,k=3 )
sc<-data.frame(scores(mds),dataset[,1:3])
head(sc)
ggplot(sc)+geom_point(aes(x=NMDS1,y=NMDS2))
ggplot(sc)+geom_point(aes(x=NMDS1,y=NMDS2,shape=fly,colour=type))
ggplot(sc)+geom_point(aes(x=NMDS1,y=NMDS2,shape=type,colour=fly))
ggplot(sc)+geom_point(aes(x=NMDS1,y=NMDS2,colour=fly))
ggplot(sc)+geom_point(aes(x=NMDS1,y=NMDS2,colour=rnorm(52)))
ggplot(sc)+geom_point(aes(x=NMDS1,y=NMDS2),colour=rnorm(52))
ggplot(sc)+geom_point(aes(x=NMDS1,y=NMDS2),colour=fly)
ggplot(sc)+geom_point(aes(x=NMDS1,y=NMDS2,colour=fly))
ggplot(sc)+geom_point(aes(x=NMDS1,y=NMDS2,size=2,colour=fly))
sc$fly
ggplot(sc)+geom_point(aes(x=NMDS1,y=NMDS2,size=2,colour=info))
ggplot(sc)+geom_point(aes(x=NMDS1,y=NMDS2,colour=info),size=2)
ggplot(sc)+geom_point(aes(x=NMDS1,y=NMDS2,colour=info,shape=type),size=2)
ggplot(sc)+geom_point(aes(x=NMDS1,y=NMDS2,colour=info,shape=type),size=3)
pca<-capscale(dataset[,-c(1:4)]~1)
pca
eigs<-eigenvals(pca)
eigs/sum(eigs)
ggplot(sc)+geom_point(aes(x=MDS1,y=MDS2,colour=info,shape=type))+labs(x="MDS1 (75.9% of variation explained)",y="MDS1 (5.8% of variation explained)")
sc<-data.frame(scores(pca)$sites,dataset[,1:4])
ggplot(sc)+geom_point(aes(x=MDS1,y=MDS2,colour=info,shape=type))+labs(x="MDS1 (75.9% of variation explained)",y="MDS1 (5.8% of variation explained)")
eigenvals(pca)
sum(eigs)
eigs/sum(eigs)
pcoa<-capscale(decostand(dataset[,-c(1:4)],"total")~1,distance="bray")
pcoa
eigs<-eigenvals(pcoa)
eigs/sum(eigs)
sc<-data.frame(scores(pcoa)$sites,dataset[,1:4])
ggplot(sc)+geom_point(aes(x=MDS1,y=MDS2,colour=info,shape=type))+labs(x="MDS1 (33.0% of variation explained)",y="MDS1 (8.2% of variation explained)")
pcoa<-capscale(decostand(dataset[,-c(1:4)],"total")~dataset$fly,distance="bray")
scores(pcoa)$centroids
ggplot(sc)+geom_point(aes(x=MDS1,y=MDS2,colour=info,shape=type))+labs(x="MDS1 (33.0% of variation explained)",y="MDS1 (8.2% of variation explained)")+annotate("text",x=c(-.157,-.077,.17),y=c(-.004,.670,.156),label=c("HYB","ORE","SAM"))
source("http://bioconductor.org/biocLite.R")
biocLite(c("pathview", "edgeR", "gage"))
100*1132416/152126075
(76)(5346216)/(152126075)
76*5346216/152126075
100*17074344/152126075
76*(5346216/4)/152126075
100*(1132416/4)/152126075
76*(5346216/4)/152126075
100*(17074344/4)/152126075
sessionInfo()
packageurl <- "http://cran.r-project.org/src/contrib/Archive/knitr/knitr_1.13.tar.gz"
install.packages(packageurl, repos=NULL, type="source")
packageurl <- "http://cran.r-project.org/src/contrib/Archive/knitr/knitr_1.12.tar.gz"
install.packages(packageurl, repos=NULL, type="source")
install.packages('stringr')
knit_with_parameters('~/Documents/NYUMC/Dasen/scripts/Dasen_RNAseq_report_controls.Rmd')
install.packages(c("knitr", "rmarkdown"))
install.packages(c("knitr", "rmarkdown"))
setwd("~/Documents/UCDavis/dib/MMETSP/git/MMETSP/")
transrate<-read.csv("assembly_evaluation_data/transrate_scores.csv")
imicrobe<-read.csv("imicrobe/Callum_FINAL_biosample_ids.csv")
ncbi<-read.csv("SraRunInfo.csv")
MMETSP_id_NCBI<-ncbi$SampleName
MMETSP_id_imicrobe<-imicrobe$SAMPLE_NAME
source('~/Documents/scripts/overLapper.R')
setlist <- list(NCBI=as.vector(MMETSP_id_NCBI),imicrobe=as.vector(MMETSP_id_imicrobe))
OLlist <- overLapper(setlist=setlist, sep="", type="vennsets")
counts <- sapply(OLlist$Venn_List, length)
vennPlot(counts=counts)
overlap<-intersect(MMETSP_id_NCBI,MMETSP_id_imicrobe)
length(overlap)
OLlist$Venn_List$NCBI
OLlist$Venn_List$imicrobe
length(unique(MMETSP_id_NCBI))
length(unique(ncbi$Run))
length(unique(MMETSP_id_imicrobe))
ncbi_719<-read.csv("SraRunInfo_719.csv")
length(unique(ncbi_719$Run))
length(unique(ncbi_719$SampleName))
extra<-ncbi_719$Run[!(ncbi_719$Run %in% ncbi$Run)]
duplicates<-ncbi_719[duplicated(ncbi_719$SampleName),]
duplicates<-ncbi_sra_duplicated_MMETSP[,c(30)]
length(duplicates)
duplicates<-duplicates[,c(30)]
length(duplicates)
duplicates<-unique(duplicates)
length(duplicates)
duplicated<-ncbi_719[(ncbi_719$SampleName %in% duplicates),]
duplicated<-duplicated[,c(1,30)]
duplicated[order(duplicated$SampleName),]
length(duplicated$SampleName)
