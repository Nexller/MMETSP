setwd("~/Documents/UCDavis/dib/MMETSP/git/MMETSP/")

transrate<-read.csv("assembly_evaluation_data/transrate_scores.csv")
transrate_reference<-read.csv("assembly_evaluation_data/transrate_reference_scores_nt.csv")
transrate_reference_subset<-transrate_reference[,c(24:42)]
busco_scores<-read.csv("assembly_evaluation_data/busco_scores.csv")
reads<-read.table("assembly_evaluation_data/trimmomatic_reads_table.txt",sep="\t",header=TRUE)
unique_kmers<-read.csv("assembly_evaluation_data/unique_kmers.txt",sep="\t",header=TRUE)
MMETSP_ncbi<-read.csv("SraRunInfo_719.csv")
colnames(MMETSP_ncbi)
MMETSP_ncbi_subset<-MMETSP_ncbi[,c(1:8,10,11,13:16,19:22,24:30,42,43,45:47)]
colnames(MMETSP_ncbi_subset)
mmetsp_id<-read.csv("imicrobe/MMETSP_Table.csv")
imicrobe<-read.csv("imicrobe/Callum_FINAL_biosample_ids.csv")


head(transrate)
colnames(transrate)
dim(transrate)
head(transrate_reference)
colnames(transrate_reference)
dim(transrate_reference)
head(busco_scores)
dim(busco_scores)
head(reads)
dim(reads)
head(unique_kmers)
dim(unique_kmers)
head(mmetsp_id)
dim(mmetsp_id)
head(MMETSP_ncbi)
dim(MMETSP_ncbi)

names_matrix<-merge(MMETSP_ncbi,mmetsp_id,by="SampleName",all.y=TRUE)
dim(names_matrix)
#write.csv(names_matrix,"imicrobe/MMETSP_ncbi_id.csv")
evaluation_matrix_1<-merge(names_matrix,transrate,by="Run",all.x=TRUE)
dim(evaluation_matrix_1)
evaluation_matrix_2<-merge(evaluation_matrix_1,transrate_reference_subset,by="Run",all.x=TRUE)
dim(evaluation_matrix_2)
evaluation_matrix_3<-merge(evaluation_matrix_2,busco_scores,by="Run",all.x=TRUE)
dim(evaluation_matrix_3)
evaluation_matrix_4<-merge(evaluation_matrix_3,reads,by="Run",all.x=TRUE)
dim(evaluation_matrix_4)
evaluation_matrix_5<-merge(evaluation_matrix_4,unique_kmers,by="Run",all.x=TRUE)
dim(evaluation_matrix_5)
write.csv(evaluation_matrix_5,"assembly_evaluation_data/MMETSP_evaluation_matrix.csv")
colnames(evaluation_matrix)
data<-evaluation_matrix[,c(1,2,94,4,8,67,72,43,44,19,26,55,142,143,93,149,148,151)]
colnames(data)
data_reads<-data[,c(3,8,15,7,12,6,13)]
head(data_reads)
write.csv(data_reads,"plotting_data.csv")
